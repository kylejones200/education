{{/*
Partial: hero_unsplash (front matter driven)
Reads params from .Page.Params.hero_unsplash
*/}}

{{ $p := .Page.Params.hero_unsplash }}
{{ if $p }}
  {{/* Defaults */}}
  {{ $sec := lower .Page.Section }}
  {{ $defaultQuery := (printf "%s" .Page.Title) }}
  {{ if eq $sec "schools" }}{{ $defaultQuery = (printf "%s campus" .Page.Title) }}{{ end }}
  {{ $query := $defaultQuery }}
  {{ $height := "60vh" }}
  {{ $title := site.Title }}
  {{ $subtitle := nil }}
  {{ $emoji := "ðŸŽ“" }}
  {{ $disable := false }}

  {{ with $p.query }}{{ $query = . }}{{ end }}
  {{ with $p.height }}{{ $height = . }}{{ end }}
  {{ with $p.title }}{{ $title = . }}{{ end }}
  {{ with $p.subtitle }}{{ $subtitle = . }}{{ end }}
  {{ with $p.emoji }}{{ $emoji = . }}{{ end }}
  {{ with $p.disable }}{{ $disable = . }}{{ end }}

  {{/* Prefer pre-fetched values from front matter if available */}}
  {{ $prefetchedUrl := nil }}
  {{ $prefetchedAlt := $query }}
  {{ $prefetchCreditName := nil }}
  {{ $prefetchCreditProfile := "https://unsplash.com" }}
  {{ $prefetchPhotoLink := "https://unsplash.com" }}

  {{ with $p.image_url }}{{ $prefetchedUrl = . }}{{ end }}
  {{ with $p.image_alt }}{{ $prefetchedAlt = . }}{{ end }}
  {{ with $p.credit_name }}{{ $prefetchCreditName = . }}{{ end }}
  {{ with $p.credit_profile }}{{ $prefetchCreditProfile = . }}{{ end }}
  {{ with $p.photo_link }}{{ $prefetchPhotoLink = . }}{{ end }}

  {{ if $prefetchedUrl }}
    <section class="hero hero--unsplash" style="position: relative; height: {{ $height }};">
      <img src="{{ $prefetchedUrl }}" alt="{{ $prefetchedAlt }}" style="object-fit: cover; width: 100%; height: 100%; display: block;" />
      <div class="hero__overlay" style="position: absolute; inset: 0; background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.35));"></div>
      <div class="hero__content" style="position: absolute; inset: 0; display: grid; place-items: center; text-align: center; color: white; padding: 1rem;">
        <div>
          <h1 style="margin: 0 0 .5rem 0;">{{ $title }}</h1>
          {{ with $subtitle }}<p style="margin: 0; font-size: 1.125rem; opacity: .95;">{{ . }}</p>{{ end }}
          {{ with $prefetchCreditName }}
            <p style="margin-top: .75rem; font-size: .8rem; opacity: .85;">
              Photo by <a href="{{ $prefetchCreditProfile }}?utm_source={{ site.Title | urlize }}&utm_medium=referral" style="color: #fff; text-decoration: underline;">{{ . }}</a>
              on <a href="{{ $prefetchPhotoLink }}?utm_source={{ site.Title | urlize }}&utm_medium=referral" style="color: #fff; text-decoration: underline;">Unsplash</a>
            </p>
          {{ end }}
        </div>
      </div>
    </section>
  {{ else }}
    <div class="hero hero--fallback" style="padding: 4rem 1rem; background: #f6f7ff; color: #2f2f41;">
      <div class="container" style="text-align:center;">
        <div style="font-size: 4rem; line-height: 1;">{{ $emoji }}</div>
        <h1 style="margin: 0 0 0.5rem 0;">{{ $title }}</h1>
        {{ with $subtitle }}<p style="margin: 0;">{{ . }}</p>{{ end }}
      </div>
    </div>
  {{ end }}
{{ end }}
